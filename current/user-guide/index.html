
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>lxml Library Reference</title>

    <style media="screen">
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cpf {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s, .highlight .sa, .highlight .dl {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf, .highlight .fm {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv, .highlight .vm {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .nl {
  color: #f92672;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <style media="print">
      * {
        -webkit-transition:none!important;
        transition:none!important;
      }
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #586e75;
}
.highlight .err {
  color: #002b36;
  background-color: #dc322f;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cm, .highlight .cpf, .highlight .c1, .highlight .cs {
  color: #657b83;
}
.highlight .cp {
  color: #b58900;
}
.highlight .nt {
  color: #b58900;
}
.highlight .o, .highlight .ow {
  color: #93a1a1;
}
.highlight .p, .highlight .pi {
  color: #93a1a1;
}
.highlight .gi {
  color: #859900;
}
.highlight .gd {
  color: #dc322f;
}
.highlight .gh {
  color: #268bd2;
  background-color: #002b36;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #6c71c4;
}
.highlight .kc {
  color: #cb4b16;
}
.highlight .kt {
  color: #cb4b16;
}
.highlight .kd {
  color: #cb4b16;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .dl, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #859900;
}
.highlight .sa {
  color: #6c71c4;
}
.highlight .sr {
  color: #2aa198;
}
.highlight .si {
  color: #d33682;
}
.highlight .se {
  color: #d33682;
}
.highlight .nn {
  color: #b58900;
}
.highlight .nc {
  color: #b58900;
}
.highlight .no {
  color: #b58900;
}
.highlight .na {
  color: #268bd2;
}
.highlight .m, .highlight .mb, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mx {
  color: #859900;
}
.highlight .ss {
  color: #859900;
}
    </style>
    <link href="stylesheets/screen-2de8c884.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print-fbfcfbe4.css" rel="stylesheet" media="print" />
      <script src="javascripts/all-a9fde460.js"></script>

  </head>

  <body class="index" data-languages="[null]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar-cad8cdcb.png" alt="" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="" />
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="Introduction">Introduction</a>
          </li>
          <li>
            <a href="#wrapping-erlsom" class="toc-h1 toc-link" data-title="Wrapping erlsom">Wrapping erlsom</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#inputs" class="toc-h2 toc-link" data-title="Inputs">Inputs</a>
                  </li>
                  <li>
                    <a href="#options" class="toc-h2 toc-link" data-title="Options">Options</a>
                  </li>
                  <li>
                    <a href="#outputs" class="toc-h2 toc-link" data-title="Outputs">Outputs</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#the-api" class="toc-h1 toc-link" data-title="The API">The API</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#start" class="toc-h2 toc-link" data-title="start"><code>start</code></a>
                  </li>
                  <li>
                    <a href="#parse" class="toc-h2 toc-link" data-title="parse"><code>parse</code></a>
                  </li>
                  <li>
                    <a href="#get-data" class="toc-h2 toc-link" data-title="get-data"><code>get-data</code></a>
                  </li>
                  <li>
                    <a href="#get-in" class="toc-h2 toc-link" data-title="get-in"><code>get-in</code></a>
                  </li>
                  <li>
                    <a href="#get-attr-in" class="toc-h2 toc-link" data-title="get-attr-in"><code>get-attr-in</code></a>
                  </li>
                  <li>
                    <a href="#get-linked" class="toc-h2 toc-link" data-title="get-linked"><code>get-linked</code></a>
                  </li>
                  <li>
                    <a href="#map" class="toc-h2 toc-link" data-title="map"><code>map</code></a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#previous-versions" class="toc-h1 toc-link" data-title="Previous Versions">Previous Versions</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#user-guide" class="toc-h2 toc-link" data-title="User Guide">User Guide</a>
                  </li>
              </ul>
          </li>
      </ul>
        <ul class="toc-footer">
            <li><a href='http://githug.com/oubiwann/lxml/'>View the source</a></li>
            <li><a href='http://github.com/tripit/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<p><em>An LFE XML Library</em></p>

<p><img src="images/professor-xavier-emile-e5432270.png" /></p>

<p>lxml is an LFE library which wraps <a href="https://github.com/willemdj/erlsom">erlsom</a>&#39;s XML-parsing capabilities and adds
an API for easily accessing the parsed data.</p>

<aside class="warning">
Note that this library has not wrapped all of erlsom; only <code>erlsom:simple_form</code>.
</aside>

<aside class="warning">
If you find any bugs or would like to have features added,
<a href="https://github.com/lfex/lxml/issues/new">let us know</a>
or send along a PR with your implementation of it!
</aside>
<h1 id='wrapping-erlsom'>Wrapping erlsom</h1>
<p>lxml only makes one call to erlsom: in the private function
<code>lxml:parse-body-raw</code>. It is through this function that all of lxml&#39;s exported
parsing functions ultimately pass. As referenced in the introduction, lxml only
supports erlsom&#39;s simple form, and this is what <code>parse-body-raw</code> calls.</p>

<p><code>erlsom:simple_form/1</code> takes either string or binary data and upon a
successful parse, returns an LFE data structure which represents the original
XML. Bot the inputs and outputs of <code>lxml:parse</code> are covered in more detail
below.</p>
<h2 id='inputs'>Inputs</h2>
<blockquote>
<p>To demonstrate string and binary inputs, let&#39;s define some data:</p>
</blockquote>
<div class="highlight"><pre class="highlight common_lisp"><code><span class="nv">lfe&gt;</span> <span class="p">(</span><span class="nb">set</span> <span class="nv">data-1</span> <span class="s">"&lt;xml&gt;data&lt;/xml&gt;"</span><span class="p">)</span>
<span class="s">"&lt;xml&gt;data&lt;/xml&gt;"</span>
<span class="nv">lfe&gt;</span> <span class="p">(</span><span class="nb">set</span> <span class="nv">data-2</span> <span class="p">(</span><span class="nv">binary</span> <span class="s">"&lt;xml&gt;data&lt;/xml&gt;"</span><span class="p">))</span>
<span class="ss">#"&lt;xml&gt;data&lt;/xml&gt;"</span>
</code></pre></div>
<blockquote>
<p>Now we can parse these and show that lxml (via erlsom) handles both string and
binary input the same:</p>
</blockquote>
<div class="highlight"><pre class="highlight common_lisp"><code><span class="nv">lfe&gt;</span> <span class="p">(</span><span class="nv">=:=</span> <span class="p">(</span><span class="nv">lxml:parse</span> <span class="nv">data-1</span><span class="p">)</span>
          <span class="p">(</span><span class="nv">lxml:parse</span> <span class="nv">data-2</span><span class="p">))</span>
<span class="nv">true</span>
</code></pre></div>
<p>lxml handles the following types of input:</p>

<ul>
<li>string XML data</li>
<li>binary XML data</li>
<li>a file whose data is XML</li>
<li>a URL that points to XML data</li>
</ul>

<p>For the first two, you simply pass lxml the data you want to parse. If you want
to parse an XML file or URL, you&#39;ll need to pass a tuple to <code>parse</code> with the
appropriate option set.</p>

<p>For more information on the <code>parse</code> function, see the &quot;API&quot; section.</p>
<h2 id='options'>Options</h2>
<p>When calling <code>parse</code> you can simply pass the data (or URL or filename), or
you can also pass a second argument: an &quot;options&quot; property list. The supported
options are:</p>

<ul>
<li><code>result-type</code> - can be the atom <code>raw</code>. When this is the case, no
processing is done on the results; they are simply returned as obtained
from erlsom. Without the <code>#(result-type raw)</code> option set, lxml will return
keys as atoms (with it, they are left as-is: strings).</li>
</ul>
<h2 id='outputs'>Outputs</h2>
<p>TBD</p>
<h1 id='the-api'>The API</h1><h2 id='start'><code>start</code></h2>
<blockquote>
<p>Starting up lxml for parsing URLs and following media links:</p>
</blockquote>
<div class="highlight"><pre class="highlight common_lisp"><code><span class="nv">lfe&gt;</span> <span class="p">(</span><span class="nv">lxml:start</span><span class="p">)</span>
<span class="o">#(</span><span class="nv">ok</span> <span class="p">(</span><span class="nv">lxml</span><span class="p">))</span>
</code></pre></div>
<p>This function simply starts the lhc LFE HTTP client. If you plan on parsing XML
from URLs or if you want to be able to call the <code>get-linked</code> function, you
will first need to call <code>start</code>.</p>
<h2 id='parse'><code>parse</code></h2>
<blockquote>
<p>For this and subsequent API functions, we will use the following
sample data, part of the lxml codebase and available in <code>./test/data.xml</code>:</p>
</blockquote>
<div class="highlight"><pre class="highlight xml tab-xml"><code><span class="nt">&lt;life&gt;</span>
  <span class="nt">&lt;bacteria</span> <span class="na">division=</span><span class="s">"domain"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;bacterium&gt;</span>spirochetes<span class="nt">&lt;/bacterium&gt;</span>
    <span class="nt">&lt;bacterium&gt;</span>proteobacteria<span class="nt">&lt;/bacterium&gt;</span>
    <span class="nt">&lt;bacterium&gt;</span>cyanobacteria<span class="nt">&lt;/bacterium&gt;</span>
  <span class="nt">&lt;/bacteria&gt;</span>
  <span class="nt">&lt;archaea</span> <span class="na">division=</span><span class="s">"domain"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;archaum&gt;&lt;/archaum&gt;</span>
  <span class="nt">&lt;/archaea&gt;</span>
  <span class="nt">&lt;eukaryota</span> <span class="na">division=</span><span class="s">"domain"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;eukaryotum&gt;</span>slime molds<span class="nt">&lt;/eukaryotum&gt;</span>
    <span class="nt">&lt;eukaryotum&gt;</span>fungi<span class="nt">&lt;/eukaryotum&gt;</span>
    <span class="nt">&lt;eukaryotum&gt;</span>plants<span class="nt">&lt;/eukaryotum&gt;</span>
    <span class="nt">&lt;eukaryotum&gt;</span>animals<span class="nt">&lt;/eukaryotum&gt;</span>
  <span class="nt">&lt;/eukaryota&gt;</span>
<span class="nt">&lt;/life&gt;</span>
</code></pre></div>
<blockquote>
<p>Parse the data normally:</p>
</blockquote>
<div class="highlight"><pre class="highlight common_lisp"><code><span class="nv">lfe&gt;</span> <span class="p">(</span><span class="nv">lxml:start</span><span class="p">)</span>
<span class="o">#(</span><span class="nv">ok</span> <span class="p">(</span><span class="nv">lxml</span><span class="p">))</span>
<span class="nv">lfe&gt;</span> <span class="p">(</span><span class="nv">lxml:parse</span> <span class="o">#(</span><span class="nv">file</span> <span class="s">"test/data.xml"</span><span class="p">))</span>
<span class="p">(</span><span class="o">#(</span><span class="nv">tag</span> <span class="s">"life"</span><span class="p">)</span>
 <span class="o">#(</span><span class="nv">attr</span> <span class="p">())</span>
 <span class="o">#(</span><span class="nv">content</span>
   <span class="o">#(</span><span class="s">"life"</span>
     <span class="p">()</span>
     <span class="p">(</span><span class="o">#(</span><span class="s">"bacteria"</span>
        <span class="p">(</span><span class="o">#(</span><span class="s">"division"</span> <span class="s">"domain"</span><span class="p">))</span>
        <span class="p">(</span><span class="o">#(</span><span class="s">"bacterium"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"spirochetes"</span><span class="p">))</span>
         <span class="o">#(</span><span class="s">"bacterium"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"proteobacteria"</span><span class="p">))</span>
         <span class="o">#(</span><span class="s">"bacterium"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"cyanobacteria"</span><span class="p">))))</span>
      <span class="o">#(</span><span class="s">"archaea"</span> <span class="p">(</span><span class="o">#(</span><span class="s">"division"</span> <span class="s">"domain"</span><span class="p">))</span> <span class="p">(</span><span class="o">#(</span><span class="s">"archaum"</span> <span class="p">()</span> <span class="p">())))</span>
      <span class="o">#(</span><span class="s">"eukaryota"</span>
        <span class="p">(</span><span class="o">#(</span><span class="s">"division"</span> <span class="s">"domain"</span><span class="p">))</span>
        <span class="p">(</span><span class="o">#(</span><span class="s">"eukaryotum"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"slime molds"</span><span class="p">))</span>
         <span class="o">#(</span><span class="s">"eukaryotum"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"fungi"</span><span class="p">))</span>
         <span class="o">#(</span><span class="s">"eukaryotum"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"plants"</span><span class="p">))</span>
         <span class="o">#(</span><span class="s">"eukaryotum"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"animals"</span><span class="p">)))))))</span>
 <span class="o">#(</span><span class="nv">tail</span> <span class="s">"\n\n"</span><span class="p">))</span>
</code></pre></div>
<blockquote>
<p>Parse the data, requesting a raw result:</p>
</blockquote>
<div class="highlight"><pre class="highlight common_lisp"><code><span class="nv">lfe&gt;</span> <span class="p">(</span><span class="nv">lxml:parse</span> <span class="o">#(</span><span class="nv">file</span> <span class="s">"test/data.xml"</span><span class="p">)</span> <span class="o">'</span><span class="p">(</span><span class="o">#(</span><span class="nv">result-type</span> <span class="nv">raw</span><span class="p">)))</span>
<span class="o">#(</span><span class="nv">ok</span>
  <span class="o">#(</span><span class="s">"life"</span>
    <span class="p">()</span>
    <span class="p">(</span><span class="o">#(</span><span class="s">"bacteria"</span>
       <span class="p">(</span><span class="o">#(</span><span class="s">"division"</span> <span class="s">"domain"</span><span class="p">))</span>
       <span class="p">(</span><span class="o">#(</span><span class="s">"bacterium"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"spirochetes"</span><span class="p">))</span>
        <span class="o">#(</span><span class="s">"bacterium"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"proteobacteria"</span><span class="p">))</span>
        <span class="o">#(</span><span class="s">"bacterium"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"cyanobacteria"</span><span class="p">))))</span>
     <span class="o">#(</span><span class="s">"archaea"</span> <span class="p">(</span><span class="o">#(</span><span class="s">"division"</span> <span class="s">"domain"</span><span class="p">))</span> <span class="p">(</span><span class="o">#(</span><span class="s">"archaum"</span> <span class="p">()</span> <span class="p">())))</span>
     <span class="o">#(</span><span class="s">"eukaryota"</span>
       <span class="p">(</span><span class="o">#(</span><span class="s">"division"</span> <span class="s">"domain"</span><span class="p">))</span>
       <span class="p">(</span><span class="o">#(</span><span class="s">"eukaryotum"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"slime molds"</span><span class="p">))</span>
        <span class="o">#(</span><span class="s">"eukaryotum"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"fungi"</span><span class="p">))</span>
        <span class="o">#(</span><span class="s">"eukaryotum"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"plants"</span><span class="p">))</span>
        <span class="o">#(</span><span class="s">"eukaryotum"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"animals"</span><span class="p">))))))</span>
  <span class="s">"\n\n"</span><span class="p">)</span>
</code></pre></div>
<p>When parsing the data normally, a 4-element property list is returned.
The keys and values of the proplist are as follows:</p>

<ul>
<li><code>tag</code> - the top-level tag of the parsed XML data</li>
<li><code>attr</code> - the attributes of the top-level tag</li>
<li><code>content</code> - the content of the top-level tag; this includes the full
XML result, minus any trailing characters</li>
<li><code>tail</code> - any trailing characters</li>
</ul>

<p>Note that XML tags with no attributes simply have an empty list in the
&quot;attrributes&quot; portion of the parsed results.</p>

<p>Normal parsing also converts nested tag names from strings to ataom.</p>

<p>When asking for raw results, the XML data is passed directly to erlsom and the
result is returned without any filtering. The data from erlsom is returned as
a 2-tuple where the elements of the tuple are as follows:</p>

<ul>
<li>status - either <code>ok</code>or <code>error</code></li>
<li>result - either the parsed data structure or an error message</li>
</ul>
<h2 id='get-data'><code>get-data</code></h2>
<blockquote>
<p>By default, <code>get-data</code> operates on a parsed result set:</p>
</blockquote>
<div class="highlight"><pre class="highlight common_lisp"><code><span class="nv">lfe&gt;</span> <span class="p">(</span><span class="nv">lxml:get-data</span> <span class="p">(</span><span class="nv">lxml:parse</span> <span class="o">#(</span><span class="nv">file</span> <span class="s">"test/data.xml"</span><span class="p">)))</span>
<span class="o">#(</span><span class="s">"life"</span>
  <span class="p">()</span>
  <span class="p">(</span><span class="o">#(</span><span class="s">"bacteria"</span>
     <span class="p">(</span><span class="o">#(</span><span class="s">"division"</span> <span class="s">"domain"</span><span class="p">))</span>
     <span class="p">(</span><span class="o">#(</span><span class="s">"bacterium"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"spirochetes"</span><span class="p">))</span>
      <span class="o">#(</span><span class="s">"bacterium"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"proteobacteria"</span><span class="p">))</span>
      <span class="o">#(</span><span class="s">"bacterium"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"cyanobacteria"</span><span class="p">))))</span>
   <span class="o">#(</span><span class="s">"archaea"</span> <span class="p">(</span><span class="o">#(</span><span class="s">"division"</span> <span class="s">"domain"</span><span class="p">))</span> <span class="p">(</span><span class="o">#(</span><span class="s">"archaum"</span> <span class="p">()</span> <span class="p">())))</span>
   <span class="o">#(</span><span class="s">"eukaryota"</span>
     <span class="p">(</span><span class="o">#(</span><span class="s">"division"</span> <span class="s">"domain"</span><span class="p">))</span>
     <span class="p">(</span><span class="o">#(</span><span class="s">"eukaryotum"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"slime molds"</span><span class="p">))</span>
      <span class="o">#(</span><span class="s">"eukaryotum"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"fungi"</span><span class="p">))</span>
      <span class="o">#(</span><span class="s">"eukaryotum"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"plants"</span><span class="p">))</span>
      <span class="o">#(</span><span class="s">"eukaryotum"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"animals"</span><span class="p">))))))</span>
</code></pre></div>
<blockquote>
<p>However, by passing options, one may call <code>get-data</code> in the following,
more concise manner:</p>
</blockquote>
<div class="highlight"><pre class="highlight common_lisp"><code><span class="nv">lfe&gt;</span> <span class="p">(</span><span class="nv">lxml:get-data</span> <span class="o">#(</span><span class="nv">file</span> <span class="s">"test/data.xml"</span><span class="p">))</span>
<span class="o">#(</span><span class="nv">life</span> <span class="p">()</span>
  <span class="p">(</span><span class="o">#(</span><span class="nv">bacteria</span> <span class="o">...</span><span class="p">)))</span>
</code></pre></div>
<blockquote>
<p>Or:</p>
</blockquote>
<div class="highlight"><pre class="highlight common_lisp"><code><span class="nv">lfe&gt;</span> <span class="p">(</span><span class="nv">lxml:get-data</span> <span class="o">#(</span><span class="nv">url</span> <span class="s">"http://example.com/data.xml"</span><span class="p">))</span>
<span class="o">#(</span><span class="nv">life</span> <span class="p">()</span>
  <span class="p">(</span><span class="o">#(</span><span class="nv">bacteria</span> <span class="o">...</span><span class="p">)))</span>
</code></pre></div>
<blockquote>
<p>Or:</p>
</blockquote>
<div class="highlight"><pre class="highlight common_lisp"><code><span class="nv">lfe&gt;</span> <span class="p">(</span><span class="nv">lxml:get-data</span> <span class="o">#(</span><span class="nv">xml</span> <span class="s">"&lt;life&gt; ... &lt;/life&gt;"</span><span class="p">))</span>
<span class="o">#(</span><span class="nv">life</span> <span class="p">()</span>
  <span class="p">(</span><span class="o">#(</span><span class="nv">bacteria</span> <span class="o">...</span><span class="p">)))</span>
</code></pre></div>
<p>The <code>get-data</code> function is provided as a convenience, as more often than not,
one cares about the <code>#(content ...)</code> tuple in the parsed property list, and
this is what <code>get-data</code> returns.</p>

<p><code>get-data</code> also provides a convenience wrapper around parse: if you provide
a tuple with any of the following keys, the parse command is called under
the covers, alleviating the user from any need to make that call. The value
keys are:</p>

<ul>
<li><code>file</code></li>
<li><code>url</code></li>
<li><code>xml</code></li>
</ul>
<h2 id='get-in'><code>get-in</code></h2>
<blockquote>
<p>First let&#39;s set some data:</p>
</blockquote>
<div class="highlight"><pre class="highlight common_lisp"><code><span class="nv">lfe&gt;</span> <span class="p">(</span><span class="nb">set</span> <span class="nv">data</span> <span class="p">(</span><span class="nv">lxml:get-data</span> <span class="o">#(</span><span class="nv">file</span> <span class="s">"test/data.xml"</span><span class="p">)))</span>
</code></pre></div>
<blockquote>
<p>Using <code>get-in</code> trivially, with one key:</p>
</blockquote>
<div class="highlight"><pre class="highlight common_lisp"><code><span class="nv">lfe&gt;</span> <span class="p">(</span><span class="nv">lxml:get-in</span> <span class="o">'</span><span class="p">(</span><span class="s">"life"</span><span class="p">)</span> <span class="nv">data</span><span class="p">)</span>
<span class="p">(</span><span class="o">#(</span><span class="s">"bacteria"</span>
   <span class="p">(</span><span class="o">#(</span><span class="s">"division"</span> <span class="s">"domain"</span><span class="p">))</span>
   <span class="p">(</span><span class="o">#(</span><span class="s">"bacterium"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"spirochetes"</span><span class="p">))</span>
    <span class="o">#(</span><span class="s">"bacterium"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"proteobacteria"</span><span class="p">))</span>
    <span class="o">#(</span><span class="s">"bacterium"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"cyanobacteria"</span><span class="p">))))</span>
 <span class="o">#(</span><span class="s">"archaea"</span> <span class="p">(</span><span class="o">#(</span><span class="s">"division"</span> <span class="s">"domain"</span><span class="p">))</span> <span class="p">(</span><span class="o">#(</span><span class="s">"archaum"</span> <span class="p">()</span> <span class="p">())))</span>
 <span class="o">#(</span><span class="s">"eukaryota"</span>
   <span class="p">(</span><span class="o">#(</span><span class="s">"division"</span> <span class="s">"domain"</span><span class="p">))</span>
   <span class="p">(</span><span class="o">#(</span><span class="s">"eukaryotum"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"slime molds"</span><span class="p">))</span>
    <span class="o">#(</span><span class="s">"eukaryotum"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"fungi"</span><span class="p">))</span>
    <span class="o">#(</span><span class="s">"eukaryotum"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"plants"</span><span class="p">))</span>
    <span class="o">#(</span><span class="s">"eukaryotum"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"animals"</span><span class="p">)))))</span>
</code></pre></div>
<blockquote>
<p>Using <code>get-in</code> with two keys:</p>
</blockquote>
<div class="highlight"><pre class="highlight common_lisp"><code><span class="nv">lfe&gt;</span> <span class="p">(</span><span class="nv">lxml:get-in</span> <span class="o">'</span><span class="p">(</span><span class="s">"life"</span> <span class="s">"bacteria"</span><span class="p">)</span> <span class="nv">data</span><span class="p">)</span>
<span class="p">(</span><span class="o">#(</span><span class="s">"bacterium"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"spirochetes"</span><span class="p">))</span>
 <span class="o">#(</span><span class="s">"bacterium"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"proteobacteria"</span><span class="p">))</span>
 <span class="o">#(</span><span class="s">"bacterium"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"cyanobacteria"</span><span class="p">)))</span>
</code></pre></div>
<blockquote>
<p>Using <code>get-in</code> with three:</p>
</blockquote>
<div class="highlight"><pre class="highlight common_lisp"><code><span class="nv">lfe&gt;</span> <span class="p">(</span><span class="nv">lxml:get-in</span> <span class="o">'</span><span class="p">(</span><span class="s">"life"</span> <span class="s">"bacteria"</span> <span class="s">"bacterium"</span><span class="p">)</span> <span class="nv">data</span><span class="p">)</span>
<span class="s">"spirochetes"</span>
</code></pre></div>
<blockquote>
<p>For a series of elements that share the same name, the first is returned by default. As such, the above is identical to this:</p>
</blockquote>
<div class="highlight"><pre class="highlight common_lisp"><code><span class="nv">lfe&gt;</span> <span class="p">(</span><span class="nv">lxml:get-in</span> <span class="o">'</span><span class="p">(</span><span class="s">"life"</span> <span class="s">"bacteria"</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">data</span><span class="p">)</span>
<span class="s">"spirochetes"</span>

</code></pre></div>
<blockquote>
<p>To get the third bacterium:</p>
</blockquote>
<div class="highlight"><pre class="highlight common_lisp"><code><span class="nv">lfe&gt;</span> <span class="p">(</span><span class="nv">lxml:get-in</span> <span class="o">'</span><span class="p">(</span><span class="s">"life"</span> <span class="s">"bacteria"</span> <span class="mi">3</span><span class="p">)</span> <span class="nv">data</span><span class="p">)</span>
<span class="s">"cyanobacteria"</span>
</code></pre></div>
<blockquote>
<p>For each of these, we could also have used <code>file</code>, <code>url</code>, or <code>xml</code>:</p>
</blockquote>
<div class="highlight"><pre class="highlight common_lisp"><code><span class="nb">&gt;</span> <span class="p">(</span><span class="nv">lxml:get-in</span> <span class="o">'</span><span class="p">(</span><span class="s">"life"</span> <span class="s">"bacteria"</span><span class="p">)</span> <span class="o">#(</span><span class="nv">file</span> <span class="s">"test/data.xml"</span><span class="p">))</span>
<span class="p">(</span><span class="o">#(</span><span class="nv">bacterium</span> <span class="p">()</span> <span class="p">(</span><span class="s">"spirochetes"</span><span class="p">))</span>
 <span class="o">#(</span><span class="nv">bacterium</span> <span class="p">()</span> <span class="p">(</span><span class="s">"proteobacteria"</span><span class="p">))</span>
 <span class="o">#(</span><span class="nv">bacterium</span> <span class="p">()</span> <span class="p">(</span><span class="s">"cyanobacteria"</span><span class="p">)))</span>
</code></pre></div>
<p><code>get-in</code> is inspired by the Clojure function of the same name and provide
an easy means of extracting data nested to any depth. A list of keys is
provided, as well as parsed XML data. It is expected that each subsequent key
frerences a child element. The parsed XML tree is walked until the last
key is reached, at which point the data at that node is returned.</p>

<p>Keys may either be atoms (keys in the proplist) or integers (1-based indices).
This allows for situations when sibling elements have the same name and
can only be distinguished by index.</p>

<p>As you may have guessed, <code>get-in</code> provides the same optional use as that
of <code>get-data</code> and supports the same tuple keys:</p>

<ul>
<li><code>file</code></li>
<li><code>url</code></li>
<li><code>xml</code></li>
</ul>
<h2 id='get-attr-in'><code>get-attr-in</code></h2>
<p>TBD</p>
<h2 id='get-linked'><code>get-linked</code></h2>
<p>TBD</p>
<h2 id='map'><code>map</code></h2>
<blockquote>
<p>Get the raw data of our sample XML file, without any of lxml&#39;s
  post-parse-processing:</p>
</blockquote>
<div class="highlight"><pre class="highlight common_lisp"><code><span class="nv">lfe&gt;</span> <span class="p">(</span><span class="nb">set</span> <span class="o">`#(</span><span class="nv">ok</span> <span class="o">,</span><span class="nv">data</span> <span class="o">,</span><span class="nv">_</span><span class="p">)</span> <span class="p">(</span><span class="nv">lxml:parse</span> <span class="o">#(</span><span class="nv">file</span> <span class="s">"test/data.xml"</span><span class="p">)</span> <span class="o">'</span><span class="p">(</span><span class="o">#(</span><span class="nv">result-type</span> <span class="nv">raw</span><span class="p">))))</span>
<span class="o">#(</span><span class="nv">ok</span>
  <span class="o">#(</span><span class="s">"life"</span>
    <span class="p">()</span>
    <span class="p">(</span><span class="o">#(</span><span class="s">"bacteria"</span>
       <span class="p">(</span><span class="o">#(</span><span class="s">"division"</span> <span class="s">"domain"</span><span class="p">))</span>
       <span class="p">(</span><span class="o">#(</span><span class="s">"bacterium"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"spirochetes"</span><span class="p">))</span>
        <span class="o">#(</span><span class="s">"bacterium"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"proteobacteria"</span><span class="p">))</span>
        <span class="o">#(</span><span class="s">"bacterium"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"cyanobacteria"</span><span class="p">))))</span>
     <span class="o">#(</span><span class="s">"archaea"</span> <span class="p">(</span><span class="o">#(</span><span class="s">"division"</span> <span class="s">"domain"</span><span class="p">))</span> <span class="p">(</span><span class="o">#(</span><span class="s">"archaum"</span> <span class="p">()</span> <span class="p">())))</span>
     <span class="o">#(</span><span class="s">"eukaryota"</span>
       <span class="p">(</span><span class="o">#(</span><span class="s">"division"</span> <span class="s">"domain"</span><span class="p">))</span>
       <span class="p">(</span><span class="o">#(</span><span class="s">"eukaryotum"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"slime molds"</span><span class="p">))</span>
        <span class="o">#(</span><span class="s">"eukaryotum"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"fungi"</span><span class="p">))</span>
        <span class="o">#(</span><span class="s">"eukaryotum"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"plants"</span><span class="p">))</span>
        <span class="o">#(</span><span class="s">"eukaryotum"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"animals"</span><span class="p">))))))</span>
  <span class="s">"\n"</span><span class="p">)</span>
</code></pre></div>
<blockquote>
<p>Using <code>lxml:map/2</code>, we can modify the content of all tags. For example,
  the following will uppercase all the content data:</p>
</blockquote>
<div class="highlight"><pre class="highlight common_lisp"><code><span class="nv">lfe&gt;</span> <span class="p">(</span><span class="nv">lxml:map</span> <span class="nf">#'</span><span class="nv">string:to_upper/1</span> <span class="nv">data</span><span class="p">)</span>
<span class="o">#(</span><span class="s">"life"</span>
  <span class="p">()</span>
  <span class="p">(</span><span class="o">#(</span><span class="s">"bacteria"</span>
     <span class="p">(</span><span class="o">#(</span><span class="s">"division"</span> <span class="s">"domain"</span><span class="p">))</span>
     <span class="p">(</span><span class="o">#(</span><span class="s">"bacterium"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"SPIROCHETES"</span><span class="p">))</span>
      <span class="o">#(</span><span class="s">"bacterium"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"PROTEOBACTERIA"</span><span class="p">))</span>
      <span class="o">#(</span><span class="s">"bacterium"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"CYANOBACTERIA"</span><span class="p">))))</span>
   <span class="o">#(</span><span class="s">"archaea"</span> <span class="p">(</span><span class="o">#(</span><span class="s">"division"</span> <span class="s">"domain"</span><span class="p">))</span> <span class="p">(</span><span class="o">#(</span><span class="s">"archaum"</span> <span class="p">()</span> <span class="p">())))</span>
   <span class="o">#(</span><span class="s">"eukaryota"</span>
     <span class="p">(</span><span class="o">#(</span><span class="s">"division"</span> <span class="s">"domain"</span><span class="p">))</span>
     <span class="p">(</span><span class="o">#(</span><span class="s">"eukaryotum"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"SLIME MOLDS"</span><span class="p">))</span>
      <span class="o">#(</span><span class="s">"eukaryotum"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"FUNGI"</span><span class="p">))</span>
      <span class="o">#(</span><span class="s">"eukaryotum"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"PLANTS"</span><span class="p">))</span>
      <span class="o">#(</span><span class="s">"eukaryotum"</span> <span class="p">()</span> <span class="p">(</span><span class="s">"ANIMALS"</span><span class="p">))))))</span>
</code></pre></div>
<blockquote>
<p>In the raw data we got back, all the tags and attirbute keys are all strings.
  What if we&#39;d like to convert those to atoms? We can use `<code>xml:map/4</code> and
  just use the identify function for processing the content, since we don&#39;t
  want that modified:</p>
</blockquote>
<div class="highlight"><pre class="highlight common_lisp"><code><span class="nv">lfe&gt;</span> <span class="p">(</span><span class="nv">lxml:map</span> <span class="nf">#'</span><span class="nv">list_to_atom/1</span> <span class="nf">#'</span><span class="nv">lxml:key-&gt;atom/1</span> <span class="nf">#'</span><span class="nv">lxml:ident/1</span> <span class="nv">data</span><span class="p">)</span>
<span class="o">#(</span><span class="nv">life</span> <span class="p">()</span>
  <span class="p">(</span><span class="o">#(</span><span class="nv">bacteria</span>
     <span class="p">(</span><span class="o">#(</span><span class="nv">division</span> <span class="s">"domain"</span><span class="p">))</span>
     <span class="p">(</span><span class="o">#(</span><span class="nv">bacterium</span> <span class="p">()</span> <span class="p">(</span><span class="s">"spirochetes"</span><span class="p">))</span>
      <span class="o">#(</span><span class="nv">bacterium</span> <span class="p">()</span> <span class="p">(</span><span class="s">"proteobacteria"</span><span class="p">))</span>
      <span class="o">#(</span><span class="nv">bacterium</span> <span class="p">()</span> <span class="p">(</span><span class="s">"cyanobacteria"</span><span class="p">))))</span>
   <span class="o">#(</span><span class="nv">archaea</span> <span class="p">(</span><span class="o">#(</span><span class="nv">division</span> <span class="s">"domain"</span><span class="p">))</span> <span class="p">(</span><span class="o">#(</span><span class="nv">archaum</span> <span class="p">()</span> <span class="p">())))</span>
   <span class="o">#(</span><span class="nv">eukaryota</span>
     <span class="p">(</span><span class="o">#(</span><span class="nv">division</span> <span class="s">"domain"</span><span class="p">))</span>
     <span class="p">(</span><span class="o">#(</span><span class="nv">eukaryotum</span> <span class="p">()</span> <span class="p">(</span><span class="s">"slime molds"</span><span class="p">))</span>
      <span class="o">#(</span><span class="nv">eukaryotum</span> <span class="p">()</span> <span class="p">(</span><span class="s">"fungi"</span><span class="p">))</span>
      <span class="o">#(</span><span class="nv">eukaryotum</span> <span class="p">()</span> <span class="p">(</span><span class="s">"plants"</span><span class="p">))</span>
      <span class="o">#(</span><span class="nv">eukaryotum</span> <span class="p">()</span> <span class="p">(</span><span class="s">"animals"</span><span class="p">))))))</span>
</code></pre></div>
<p><code>map</code> functions typically operate over lists of arbitrary data; the function
passed to the <code>map</code> function is what is expected to know something about the
list data. The <code>map</code> functions in lxml are significantly different than
standard <code>map</code> functions in the following ways:</p>

<ul>
<li>They operate on nested data,</li>
<li>They understand that the lists will contain either the 3-tuple of parsed XML
data, or a list of attribute typles, and</li>
<li>There are potentially three functions one may pass: on to operate on the tag,
one on the attributes, and another on the contents.</li>
</ul>

<p>As a result of the last bullet point, <code>lxml:map</code> comes in three arities:</p>

<ul>
<li><code>xml:map/2</code> - takes a content-manipulating function and parsed XML data</li>
<li><code>lxml:map/3</code> - takes an attribute-manipulating function,
a content-manipulating function, and parsed XML data</li>
<li><code>lxml:map/4</code> - takes s tag-manipulating function,
an attribute-manipulating function,
a content-manipulating function, and parsed XML data</li>
</ul>
<h1 id='previous-versions'>Previous Versions</h1><h2 id='user-guide'>User Guide</h2>
<p>The User Guide is available for the following versions:</p>

<ul>
<li><a href="../user-guide/">Current</a></li>
<li><a href="../user-guide/">0.3.0</a></li>
<li><a href="../../0.1.0/user-guide/">0.1.0</a></li>
<li><a href="../../0.0.1/user-guide/">0.0.1</a></li>
</ul>

      </div>
      <div class="dark-box">
      </div>
    </div>
  </body>
</html>
